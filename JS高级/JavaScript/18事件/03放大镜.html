<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<style type="text/css">
			*{
				margin:0;
				padding:0;
			}
			body{
				overflow: hidden;
			}
			#all{
				
				overflow: hidden;
				margin: 80px ;
			}
			#min,#max{
				width:350px;
				height:350px;
				border:1px solid darkgray;
				float: left;
				margin-right: 20px;
				position: relative;
			}
			
			#max{
				overflow: hidden;
				
				display: none;
			}
			#mask{
				width:50px;
				height:50px;
				background-color: lightgray;
				position: absolute;
				opacity: 0.5;
				display: none;
			}
		
			#maxImg{
				position: absolute;
			}
		</style>
	</head>
	<body>
		<div id="all">
			<div id="min">
				<img src="img/small.jpg"/>
				<div id="mask"></div>
			</div>
			<div id="max">
				<img src="img/big.jpg" id = "maxImg" />
			</div>
			
		</div>
		<script type="text/javascript">
			var oMin = document.getElementById("min");
			var oMax = document.getElementById("max");
			var oMask = document.getElementById("mask");
			var oMaxImg = document.getElementById("maxImg");
			
			oMin.onmouseover = function(){
				oMax.style.display = "block";
				oMin.onmousemove = function(ev){
					var ev = ev || window.event;
					oMask.style.display = "block";
//					oMask.style.left = ev.clientX - oMask.offsetWidth / 2  - 80+ "px";
//					oMask.style.top = ev.clientY - oMask.offsetHeight / 2 - 80 + "px";
					
					//获取鼠标相对min的位置
					var mX = ev.pageX - oMin.offsetLeft;
					var mY = ev.pageY - oMin.offsetTop;
					
					//可以移动的距离
					var maxW = oMin.clientWidth - oMask.offsetWidth;
					var maxH = oMin.clientHeight - oMask.offsetHeight;
					
					//蒙版的位置
				    var maskL = mX - oMask.offsetWidth / 2;
				    var maskT = mY - oMask.offsetHeight / 2;
				    
				    if(maskL >= maxW){
				    maskL = maxW;
				    }else if(maskL <= 0){
				    	maskL = 0;
				    }
				     if(maskT >= maxH){
				    maskT = maxH;
				    }else if(maskT <= 0){
				    	maskT = 0;
				    }
				    oMask.style.left =  	maskL+ "px";
					oMask.style.top = 	maskT+ "px";
				    
					//比例系数
					var radioX = maskL / maxW;
					var radioY = maskT / maxH;
					
					oMaxImg.style.left = (oMax.clientWidth - oMaxImg.offsetWidth) * radioX  + "px";
					oMaxImg.style.top  = (oMax.clientHeight - oMaxImg.offsetHeight) * radioY  + "px";
					
				}
				
			}
			oMin.onmouseout = function(){
				oMask.style.display = "none";
				oMax.style.display = "none";
			}
			
		</script>
	</body>
</html>
