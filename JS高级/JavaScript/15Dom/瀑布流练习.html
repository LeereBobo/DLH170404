<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<style>
			html,body,ul,li{
				margin:0;
				padding:0;
			}
			ul,li{
				list-style: none;
			}
			#list{
				position: relative;
				margin:0 auto;
			}
			#list>li{
				border:1px solid darkgray;
				width:188px;
				padding:5px;
				position:absolute;
				top:0;
				left:0;
				transition: all 1s;
			}
			#list>li>img{
				width:100%;
			}
		</style>
	</head>
	<body>
	<ul id="list"></ul>
	
	<script type="text/javascript">
		var oList = document.getElementById("list");
		var  oLis = document.getElementsByTagName("li");
		var colsH = [];
		var space = 10 ;
		var colW = 200;
		loadImg();
		 window.onload = function(){
		 	createFall();
		 }
		 window.onresize = function(){
		 	createFall();
		 }
		 window.onscroll = function(){
		 	var winH = document.documentElement.clientHeight;
		 	var theTop = document.body.scrollTop;
		 	var pageH = document.documentElement.scrollHeight;
		 	if((winH + pageH) / pageH >= 0.9){
		 		loadImg();
		 		createFall();
		 	}
		 }
		
		function loadImg(){
			for(var i = 0 ; i < 30;i++){
				var newLi = document.createElement("li");
				oList.appendChild(newLi);
				var newImg = new Image();
				newLi.appendChild(newImg);
				newImg.src = "image/" + i + ".jpg";;
			}
		}
		function createFall(){
			var winH = document.documentElement.clientWidth;
			var cols = parseInt( winH / (space + colW));
			oList.style.width = cols * (space + colW) - space + "px";
			for(var i = 0 ; i < cols; i++){
				colsH[i] = 0;
			}
			
			
			
			for(var i = 0 ; i < oLis.length; i++){
				var minIndex = getMinIndex();
				oLis[i].style.left = minIndex * (colW + space) + "px";
				oLis[i].style.top = colsH[minIndex] + "px";
				colsH[minIndex] += oLis[i].offsetHeight + space;
			}
		}
		
		function getMinIndex(){
			var minIndex = 0;
			var minHeight = colsH[0];
			for(var i = 0 ; i < colsH.length; i++){
				if(minHeight > colsH[i]){
					minHeight = colsH[i];
					minIndex = i;
				}
			}
			return minIndex;
		}
	</script>
	</body>
</html>
