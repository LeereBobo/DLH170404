<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<style type="text/css">
			* {
				margin: 0;
				padding: 0;
			}
			
			#all {
				width: 800px;
				height: 800px;
				border: 5px solid black;
				position: relative;
				margin: 0 auto;
			}
			
			#all div {
				width: 50px;
				height: 50px;
				opacity: 0.5;
				position: absolute;
				display: block;
			}
			#div1{
				z-index: 2;
			}
		</style>
	</head>

	<body>
		<div id="all">
			<div id="div1"></div>
			<div></div>
			<div></div>
			<div></div>
			<div></div>
		</div>
	</body>

	<script type="text/javascript">
		var oAll = document.getElementById("all");
		var oDivs = oAll.getElementsByTagName("div");
		var oDiv1 = document.getElementById("div1");
		var colors = ["red", "blue", "yellow", "black", "green"];

		//每个小div设置定位和颜色
		for(var i = 0; i < oDivs.length; i++) {
			oDivs[i].style.backgroundColor = colors[i];
			oDivs[i].style.left = (i + 1) * 100 + "px";
			oDivs[i].style.top = (i + 1) * 100 + "px";
			oDivs[i].style.zIndex = (6 - i);
		}
        
		oDiv1.onmousedown = function(ev) {
			oDiv1.onmousemove = function(ev) {
				var ev = ev || window.event;
				//设置移动的div不能超过边框
				var leftType = ev.clientX >= oAll.offsetLeft + oDiv1.offsetWidth / 2;
				var rigthType = ev.clientX <= oAll.offsetWidth + oAll.offsetLeft - oDiv1.offsetWidth / 2 - 10;
				var topType = ev.clientY >= oAll.offsetTop + oDiv1.offsetHeight / 2;
				var bottomType = ev.clientY <= oAll.offsetHeight + oAll.offsetTop - oDiv1.offsetHeight / 2 - 10;
				
				if(leftType && rigthType && topType && bottomType){
				oDiv1.style.left = ev.clientX - oAll.offsetLeft - oDiv1.offsetWidth / 2 + "px";
				oDiv1.style.top = ev.clientY - oAll.offsetTop -  oDiv1.offsetHeight / 2 + "px";
				}
				
				//第一个div碰到其他的div, 其他的div消失
				for(var i = 1; i < oDivs.length; i++){
					var divsLeft = (oDiv1.offsetLeft + oDiv1.offsetWidth) >= (oDivs[i].offsetLeft) ;
					var divRight = oDiv1.offsetLeft <= (oDivs[i].offsetLeft + oDivs[i].offsetWidth);
					var divTop = (oDiv1.offsetTop + oDiv1.offsetHeight) >= oDivs[i].offsetTop;
					var divBottom = oDiv1.offsetTop <= (oDivs[i].offsetTop + oDivs[i].offsetHeight);
					
					if(divsLeft && divRight && divTop && divBottom){
						oDivs[i].style.display = "none";
					}
				}
			}
		}
		oDiv1.onmouseup = function() {
			oDiv1.onmousemove = null;
		}
	</script>

</html>