<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<style type="text/css">
			* {
				margin: 0;
				padding: 0;
				font-family: "微软雅黑";
			}
			
			#wrap {
				background: url(img/game_bg.jpg) 0 0 no-repeat;
				height: 480px;
				width: 320px;
				position: relative;
				margin: 0 auto;
			}
			
			#score {
				position: absolute;
				font-weight: bold;
				font-size: 16px;
				color: white;
				left: 65px;
				top: 15px;
			}
			
			#countDown {
				position: absolute;
				background: url(img/progress.png) 0 0 no-repeat;
				/*background-color: red;*/
				width: 180px;
				height: 16px;
				left: 63px;
				top: 66px;
			}
			
			#wolfs {
				position: absolute;
			}
			
			#menu {
				position: absolute;
				width: 320px;
				text-align: center;
				left: 0;
				top: 200px;
			}
			
			#start,
			#handle,
			#gameOver {
				cursor: pointer;
				line-height: 50px;
				font-size: 30px;
				font-weight: bold;
				color: #F60;
				text-shadow: 0 0 5px #FFFF00;
				display: block;
				text-decoration: none;
			}
			
			#gameOver {
				position: absolute;
				width: 320px;
				text-align: center;
				top: 200px;
				left: 0;
				display: none;
			}
		</style>
	</head>

	<body>

		<div id="wrap">
			<!--分数-->
			<div id="score">0</div>
			<!--倒计时-->
			<div id="countDown"></div>
			<!--灰太狼-->
			<div id="wolfs">

			</div>
			<div id="menu">
				<div id="start">开始</div>
				<div id="handle">游戏开始说明</div>
			</div>
			<div id="gameOver">
				game over!
			</div>
		</div>

	</body>

	<script type="text/javascript">
		var oScore = document.getElementById("score");
		var oWolfs = document.getElementById("wolfs");
		var oStart = document.getElementById("start");
		var oMenu = document.getElementById("menu");
		var oCountDown = document.getElementById("countDown");
		var oGameOver = document.getElementById("gameOver");
		var moveTimer = null;

		//灰太狼图片路径
		var wolf_1 = ['img/h0.png', 'img/h1.png', 'img/h2.png', 'img/h3.png', 'img/h4.png', 'img/h5.png', 'img/h6.png', 'img/h7.png', 'img/h8.png', 'img/h9.png'];
		//小灰灰图片路径
		var wolf_2 = ['img/x0.png', 'img/x1.png', 'img/x2.png', 'img/x3.png', 'img/x4.png', 'img/x5.png', 'img/x6.png', 'img/x7.png', 'img/x8.png', 'img/x9.png'];
		var wolfArr = [wolf_1, wolf_2];

		var score = 0; //记录分数
		//出现
		var arrPos = [{
			l: "98px",
			t: "115px"
		}, {
			l: "17px",
			t: "160px"
		}, {
			l: "15px",
			t: "220px"
		}, {
			l: "30px",
			t: "293px"
		}, {
			l: "122px",
			t: "273px"
		}, {
			l: "207px",
			t: "295px"
		}, {
			l: "200px",
			t: "211px"
		}, {
			l: "187px",
			t: "141px"
		}, {
			l: "100px",
			t: "185px"
		}];

		oStart.onclick = function() {
			oMenu.style.display = "none";
			createWolf();
			startCountDown();
		}

		function startCountDown() {
			var countDownTimer = null;
			countDownTimer = setInterval(function() {
				var attrvalue = oCountDown.offsetWidth;
				var speed = 5;
				if(attrvalue == 0){
					clearInterval(countDownTimer);
					clearInterval(moveTimer);
					oGameOver.style.display = "block";
					oWolfs.removeChild(oWolfs.children[0]);
				}else{
					oCountDown.style.width = attrvalue - speed + "px";
				}

			}, 1000);
		}

		function createWolf() {
			var newWolf = new Image();
			oWolfs.appendChild(newWolf);
			//随机狼出现的位置
			var wolfPosition = getRandom(8, 0);
			oWolfs.style.left = arrPos[wolfPosition]["l"];
			oWolfs.style.top = arrPos[wolfPosition]["t"];
			//随机出现灰太狼0或者小灰灰1
			var wolfType = getRandom(4, 0) == 3 ? 1 : 0;
			var count = 0; //记录定时器走过的次数
			var index = 0; //记录图片的下标
			moveTimer = setInterval(function() {
				if(count < 6) {
					newWolf.src = wolfArr[wolfType][index];
					index++;
				} else if(count >= 6 && count <= 11) {
					index--;
					newWolf.src = wolfArr[wolfType][index];
				} else {
					clearInterval(moveTimer);
					oWolfs.removeChild(newWolf);
					createWolf();
				}
				count++;
			}, 50);

			//按钮点击  第一次执行函数内的代码.第二次不执行
			//定义变量   第一次点击可以进入判断  改变它的值
			var isFirstClick = true;
			oWolfs.onclick = function() {

				if(isFirstClick) {
					isFirstClick = !isFirstClick;
					if(wolfType == 0) {
						score += 10;
					} else {
						score -= 10;
					}
					oScore.innerHTML = score;

					//不管之间是哪张图片,都变成被打带锅的图片
					clearInterval(moveTimer);
					index = 6;
					moveTimer = setInterval(function() {
						if(index <= 9) {
							newWolf.src = wolfArr[wolfType][index];
							index++;

						} else {
							clearInterval(moveTimer);
							oWolfs.removeChild(newWolf);
							createWolf();
						}
					}, 50);
				}
			}
		}
		//随机数
		function getRandom(max, min) {
			return Math.floor(Math.random() * (max - min + 1) + min);
		}
	</script>

	</body>

</html>