<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="UTF-8">
    <title>Title</title>
    <style type="text/css">
        @font-face {
            font-family:"华夫";
            src: url("字体/新蒂泡芙体.otf");
        }
        body {
            background-color: whitesmoke;
        }
        .main {
            width: 800px;
            border: 5px dashed black;
            border-radius: 3px;
            margin: 10px auto;
            padding: 8px;
            background-color:white;

            /*opacity: 0.5;*/
        }

        .text {
            font-family: 华夫;
            color: black;
            font-weight: bold;
            font-size: 17px;
            margin: 10px;
            /*border: 1px solid black;*/
        }

        .bottom {
            margin: 10px;
            overflow: hidden;
            color: darkgray;
            /*border: 1px solid red;*/
        }

        .left {
            float: left;
            /*border: 1px solid black;*/
        }

        .right {
            float: right;
            /*border: 1px solid black;*/
        }
        #btn {
            width: 60px;
            height: 30px;
            border-radius:5px;
            position: absolute;
            left: 10px;
            top: 30px;
        }
    </style>
</head>
<body>

<div id="big">
    <!--<div class="main">-->
        <!--<div class="text">-->
            <!--这年头什么也靠不住,只有自己靠自己,简称:我…靠!-->
        <!--</div>-->
        <!--<div class="bottom">-->
            <!--<div class="left">-->
                <!--来源: 等等往-->
            <!--</div>-->
            <!--<div class="right">-->
                <!--回复:444-->
            <!--</div>-->
        <!--</div>-->
    <!--</div>-->
</div>

<button id="btn" onclick="abc()">刷新</button>
<script>
    var oBig = document.getElementById("big");
    abc();
    function abc() {
        oBig.innerHTML = "";
        ajax_get("01接口.php",function (result) {
            var resultJson = JSON.parse(result);
            for(var i = 0; i < resultJson["段子"].length; i++){
                var small_Json = resultJson["段子"][i];
                var digest = small_Json["digest"];
                var replyCount = small_Json["replyCount"];
                var source = small_Json["source"];
                creatElement(digest,source,replyCount);
            }
        });
    }


    function creatElement(digest,source,relyCount) {
        var mainDiv = document.createElement("div");
        mainDiv.className = "main";
        oBig.appendChild(mainDiv);

        var textDiv = document.createElement("div");
        textDiv.className = "text";
        mainDiv.appendChild(textDiv);
        textDiv.innerHTML = digest;

        var bottomDiv = document.createElement("div");
        bottomDiv.className = "bottom";
        mainDiv.appendChild(bottomDiv);

        var leftDiv = document.createElement("div");
        leftDiv.className = "left";
        bottomDiv.appendChild(leftDiv);
        leftDiv.innerHTML = source;

        var rightDiv = document.createElement("div");
        rightDiv.className = "right";
        bottomDiv.appendChild(rightDiv);
        rightDiv.innerHTML = relyCount;

    }

    function ajax_get(url,callback) {
        var xhr = null;
        if(window.XMLHttpRequest){
            xhr = new XMLHttpRequest();
        }else{
            xhr = new ActiveXObject("Microsoft.XMLHTTP");
        }
        xhr.open("get",url,true);
        xhr.send();
        xhr.onreadystatechange = function () {
            console.log(xhr.readyState);
            if(xhr.readyState == 4){
                if(xhr.status == 200){
                    callback(xhr.responseText);
                }
            }
        }
    }
</script>
</body>
</html>



