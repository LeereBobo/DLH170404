<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<style type="text/css">
			#wrap {
				width: 500px;
				height: 40px;
				background-color: lightgray;
				border-radius: 40px;
				position: relative;
				margin: 0 auto;
			}
			
			#div1 {
				width: 40px;
				height: 40px;
				background: pink;
				border-radius: 40px;
				position: absolute;
			}
			
			#div2 {
				background-color: lightgreen;
				position: absolute;
				top: 290px;
				left: 250px;
			}
		</style>
	</head>

	<body>
		<div id="wrap">
			<div id="div1">


			</div>

		</div>
		<div id="div2">

		</div>
		<script src="jquery-1.11.2.min.js"></script>
		<script type="text/javascript">
			$(function() {
				var maxW = $("#wrap").outerWidth() - $("#div1").outerWidth();
				$("#div1").mousedown(function(ev) {
					var ev = ev || window.event;
					var mx_div = ev.clientX;
					var my_div = ev.clientY;
					//获取相对于父级的偏移量
					var divL = $("#div1").position().left;
					var divT = $("#div1").position().top;
					//console.log($("#div1").position().left,$("#div1").position().top);
					//console.log($("#div1").offset().left,$("#div1").offset().top);
					$("#wrap").mousemove(function(ev) {
						var ev = ev || window.event;
						var mx = ev.clientX;
						var my = ev.clientY;
						//console.log(mx,my);
						var theLeft = mx - mx_div + divL;
						if(theLeft <= 0) {
							theLeft = 0;
						} else if(theLeft >= maxW) {
							theLeft = maxW;
						}
						$("#div1").css({
							left : theLeft
						});
						var ratioX = $("#div1").position().left / maxW;
						$("#div2").width(ratioX * 500);
						$("#div2").height(ratioX * 500);
						$("#div2").css({
							marginLeft : -$("#div2").width() / 2,
							marginTop : -$("#div2").height() / 2
						});
					})
				})
				$("#div1").mouseup(function() {
					$("#wrap").off("mousemove");
				})
				$("#wrap").mouseleave(function() {
					$("#wrap").off("mousemove");
				})
			});
		</script>
	</body>

</html>