<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<style type="text/css">
			body,
			html {
				width: 100%;
				height: 100%;
			}
			
			body {
				background-color: lightblue;
				position: relative;
			}
			
			#btn {
				font-size: 20px;
				background-color: lightgray;
			}
			
			#wrap>span {
				display: inline-block;
				margin: 0 25px;
				padding: 6px;
				font-size: 20px;
				background-color: lightgray;
			}
			
			.letters {
				font-size: 50px;
				color: hotpink;
				font-weight: border;
				/*float: left;*/
				position: absolute;
				/*top: 0;
				left: 0;*/
			}
		</style>

	</head>

	<body>
		<div id="wrap">
			<button id="btn">开始</button>
			<span id="div1">分数:0</span>
			<span id="div2">倒计时:20</span>
		</div>

		<script type="text/javascript">
			var oWrap = document.getElementById("wrap");
			var oBtn = document.getElementById("btn");
			var oDiv1 = document.getElementById("div1");
			var oDiv2 = document.getElementById("div2");
			var score = 0;
			var timer = null;
			var timerNum = 20;
			//随机keycode
			function getRandom(min, max) {
				return Math.floor(Math.random() * (max - min + 1) + min);
			}

			oBtn.onclick = function() {
				
				creatABC();

				document.onkeydown = function(e) {
					var e = e || window.event;
					var codeL = String.fromCharCode(e.keyCode);
					var letters = document.getElementsByClassName("letters");
					for(var i = 0; i < letters.length; i++) {
						if(codeL == letters[i].innerHTML) {
							document.body.removeChild(letters[i]);
							oDiv1.innerHTML = "分数:" + ++score;

						}
					}

				}

				if(timer == null) {

					timer = setInterval(function() {
						oDiv2.innerHTML = "倒计时:" + --timerNum;
						
						if(timerNum == 0) {
							clearTimer();	
							alert("游戏结束");
							document.onkeydown = null;
							var letters = document.getElementsByClassName("letters");
						
							
							
						}

					}, 1000);
				}

			}
			
			function clearTimer(){
				var timer = setTimeout(function(){
					for (var i = 1;i < timer;i++) {
						clearInterval(i);
					}
				},10)
			}

			function creatABC() {
				setInterval(function() {
					var theLetter = document.createElement("div");
					theLetter.setAttribute("class", "letters");
					document.body.appendChild(theLetter);
					var a = getRandom(65, 90);
					var b = String.fromCharCode(a);
					theLetter.innerHTML = b;

					var maxL = document.documentElement.clientWidth - theLetter.offsetWidth;
					theLetter.style.left = getRandom(0, maxL) + "px";

					var speedL = getRandom(1, 10);
					linearMove(theLetter, speedL, document.documentElement.clientHeight);

				}, 100);
			}

			function linearMove(obj, speed, iTarget) {

				obj.timer = setInterval(function() {
					if(iTarget - obj.offsetTop <= speed) {
						clearInterval(obj.timer);
						document.body.removeChild(obj);
					} else {
						obj.style.top = obj.offsetTop + speed + "px";

					}

				}, 30);
			}
		</script>

	</body>

</html>