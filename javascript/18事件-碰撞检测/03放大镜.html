<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<style type="text/css">
			#min,
			#max {
				width: 350px;
				height: 350px;
				border: 1px solid black;
				float: left;
				margin-right: 20px;
				position: relative;
			}
			
			#all {
				padding: 50px;
			}
			
			#all::after {
				content: "";
				display: table;
				clear: both;
			}
			
			#mask {
				width: 100px;
				height: 100px;
				background-color: lightgrey;
				position: absolute;
				top: 0;
				left: 0;
				opacity: 0.8;
				display: none;
			}
			
			#max {
				overflow: hidden;
			}
			
			#max img {
				position: absolute;
			}
		</style>
	</head>

	<body>
		<div id="all">
			<div id="min">
				<img src="../images/min.jpg" />
				<div id="mask"></div>

			</div>

			<div id="max">
				<img id="maxImg" src="../images/max.jpg" />
			</div>
		</div>

		<script type="text/javascript">
			var oMin = document.getElementById("min");
			var oMax = document.getElementById("max");
			var oMask = document.getElementById("mask");
			var oMaxImg = document.getElementById("maxImg");

			oMin.onmouseover = function() {
				oMask.style.display = "block";
				oMax.style.display = "block"

			}

			oMin.onmouseout = function() {
				oMask.style.display = "none";
				oMax.style.display = "none";
			}

			oMin.onmousemove = function(ev) {
				var ev = ev || window.event;

				//获取鼠标相对于min的位置
				var mX = ev.pageX - oMin.offsetLeft;
				var mY = ev.pageY - oMin.offsetTop;
				
				//可以移动的范围
				var maxW = oMin.clientWidth - oMask.offsetWidth;
				var maxH = oMin.clientHeight - oMask.offsetHeight;
				
				//蒙版的位置
				var maskL = mX - oMask.offsetWidth / 2;
				var maskT = mY - oMask.offsetHeight / 2;
				
				//判断临界值
				if (maskL >= maxW) {
					maskL = maxW;
				}else if (maskL <= 0) {
					maskL = 0;
				}
				
				if (maskT >= maxH) {
					maskT = maxH;
				}else if (maskT <= 0) {
					maskT = 0;
				}
				oMask.style.left = maskL + "px";
				oMask.style.top = maskT + "px";
				
				//比例系数
				var radioX = maskL / maxW;
				var radioY = maskT / maxH;

                oMaxImg.style.left = (oMax.clientWidth - oMaxImg.offsetWidth) * radioX + "px";
				oMaxImg.style.top = (oMax.clientHeight - oMaxImg.offsetHeight) * radioX + "px";

				/*console.log(oMaxImg.style.left);
				console.log(oMaxImg.style.top);
				console.log(oMaxImg.offsetWidth);*/

			}
		</script>
	</body>

</html>