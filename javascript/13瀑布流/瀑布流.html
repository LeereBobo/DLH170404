<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<style type="text/css">
			html,body ,ul,li{
				margin: 0;
				padding: 0;
			}
			
			ul,li {
				list-style: none;
			}
			
			#list {
				position: relative;
				margin: 0 auto;
				
			}
			
			#list>li {
				width: 188px;
				border: 1px solid darkgray;
				padding: 5px;
				position: absolute;
				top: 0;
				left: 0;
				transition: all 10s;
				
			}
			#list>li>img {
				width: 100%;
			}
			
		</style>
	</head>
	<body>
		<ul id="list">
			
		</ul>
		
		
		<script type="text/javascript">
			
			var oList = document.getElementById("list");
			var oLis = document.getElementsByTagName("li");
			var imgs = ["images/1.jpg","images/2.jpg","images/3.jpg","images/4.jpg","images/5.jpg",
			"images/6.jpg","images/7.jpg",
			"images/8.jpg","images/9.jpg","images/10.jpg","images/11.jpg","images/12.jpg",
			"images/13.jpg","images/14.jpg","images/15.jpg","images/16.jpg",
			"images/17.jpg","images/18.jpg","images/19.jpg","images/20.jpg"];
			//每列的宽
			var colw = 200;
			
			//间距
			var margin = 10;
			
			//获取窗口的可视宽度
			var innerW = document.documentElement.clientWidth;
			
			//计算列数
			var cols = parseInt(innerW / (colw + margin));
			
			//设置ul的宽度
			oList.style.width = cols * (colw + margin) - margin + "px";
			
			//记录每列高度的数组
			var colsH = [];
			
			//初始化高度数组:未添加前数组为null,初始化后非null,只是其中元素高度为0
			for(var i = 0; i < cols; i++){
				colsH[i] = 0;
			}
			//加载图片
			function loadimg(){
				for(var i = 0; i < imgs.length; i++){
					var newli = document.createElement("li");
					
					//创建图片对象
					var newimg = new Image();
					newimg.src = imgs[i];
					
					//加载完之前先隐藏
					newli.style.opacity = 0;
					
					//img -> li   li ->ul
					newli.appendChild(newimg);
					oList.appendChild(newli);
					
				}
			}
			loadimg();
			
			//生成瀑布流
			function createfall(){
				for(var i = 0;i < oLis.length; i++){
					//获取最短列的下标
					var minIndex = getMinIndex();
					
					//设置当前li的Top值
					//当前li的高度 = 最短li的高度 + margin
					oLis[i].style.top = colsH[minIndex] + margin + "px";
					
					//设置当前li的left值
					oLis[i].style.left = (colw + margin) * minIndex + "px";
				    //加载完之后显示
				    oLis[i].style.opacity = 1;
				    //更新列的高度
				    colsH[minIndex] += margin + oLis[i].offsetHeight;
					
					
					
				}
			}
			//计算最短列下标函数
			function getMinIndex(){
				
				//下标
				var minIndex = 0;
				var minH = colsH[0];
				for(var i = 0;i < colsH.length; i++){
					if(minH > colsH[i]){
						
						//获取最小值与最小下标
						minH = colsH[i];
						minIndex = i;
					}
				}
				return minIndex;
			}
			
			//加载完成后执行
			window.onload = function(){
				createfall();
			}
			
		
			
			
			
			
			
		</script>
	</body>
</html>
