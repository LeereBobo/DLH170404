<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title></title>
		<style type="text/css">
			* {
				margin: 0;
				padding: 0;
				font-family: "微软雅黑";
			}
			
			#wrap {
				background: url(../img7/game_bg.jpg) 0 0 no-repeat;
				height: 480px;
				width: 320px;
				position: relative;
				margin: 0 auto;
			}
			
			#score {
				position: absolute;
				font-weight: bold;
				font-size: 16px;
				color: white;
				left: 65px;
				top: 15px;
			}
			
			#countDown {
				position: absolute;
				background: url(../img7/progress.png) 0 0 no-repeat;
				/*background-color: red;*/
				width: 180px;
				height: 16px;
				left: 63px;
				top: 66px;
			}
			
			#wolfs {
				position: absolute;
			}
			
			#menu {
				position: absolute;
				width: 320px;
				text-align: center;
				left: 0;
				top: 200px;
			}
			
			#start,
			#handle,
			#gameOver {
				line-height: 50px;
				font-size: 30px;
				font-weight: bold;
				color: #F60;
				text-shadow: 0 0 5px #FFFF00;
				display: block;
				text-decoration: none;
			}
			
			#gameOver {
				position: absolute;
				width: 320px;
				text-align: center;
				top: 200px;
				left: 0;
				display: none;
			}
		</style>
	</head>

	<body>

		<div id="wrap">
			<!--分数-->
			<div id="score">0</div>
			<!--倒计时-->
			<div id="countDown"></div>
			<!--灰太狼-->
			<div id="wolfs">

			</div>
			<div id="menu">
				<div id="start">开始</div>
				<div id="handle">游戏开始说明</div>
			</div>
			<div id="gameOver">
				game over!
			</div>
		</div>

	</body>

	<script type="text/javascript">
		var oScore = document.getElementById("score");
		var oWolfs = document.getElementById("wolfs");
		var oStart = document.getElementById("start");
		var oMenu = document.getElementById("menu");
		var oCountDown = document.getElementById("countDown");
		var oGameOver = document.getElementById("gameOver");
		var moveTimer = null;
		var score = 0; //记录分数
		//出现
		var arrPos = [{
			l: "98px",
			t: "115px"
		}, {
			l: "17px",
			t: "160px"
		}, {
			l: "15px",
			t: "220px"
		}, {
			l: "30px",
			t: "293px"
		}, {
			l: "122px",
			t: "273px"
		}, {
			l: "207px",
			t: "295px"
		}, {
			l: "200px",
			t: "211px"
		}, {
			l: "187px",
			t: "141px"
		}, {
			l: "100px",
			t: "185px"
		}];

		//灰太狼图片路径
		var wolf_1 = ["../img7/h0.png", "../img7/h1.png", "../img7/h2.png", "../img7/h3.png",
			"../img7/h4.png", "../img7/h5.png", "../img7/h6.png", "../img7/h7.png",
			"../img7/h8.png", "../img7/h9.png"
		];

		//小灰灰图片路径
		var wolf_2 = ["../img7/x0.png", "../img7/x1.png", "../img7/x2.png", "../img7/x3.png",
			"../img7/x4.png", "../img7/x5.png", "../img7/x6.png", "../img7/x7.png",
			"../img7/x8.png", "../img7/x9.png"
		];

		var wolfArr = [wolf_1, wolf_2];

		oStart.onclick = function() {
			oMenu.style.display = "none";
			createWolf();
			startCountDown();

		}

		//定时器倒计时
		function startCountDown() {
			var countDownTimer = null;
			countDownTimer = setInterval(function() {
				var attrValue = oCountDown.offsetWidth;
				var speed = 1;
				if(attrValue == 0) {
					clearInterval(countDownTimer);
					clearInterval(moveTimer);
					oGameOver.style.display = "block";
					oWolfs.removeChild(oWolfs.children[0]);
				} else {
					oCountDown.style.width = (attrValue - speed) + "px";

				}

			}, 100);
		}

		function ran(min, max) {
			return Math.floor(Math.random() * (max - min + 1) + min);
		}

		function createWolf() {
            //图片 - > div
            var newWolf = new Image();
            oWolfs.appendChild(newWolf);

            //div - > 坑
            //随机狼出现的位置
            var wolfposition = ran(0, 8);
            oWolfs.style.left = arrPos[wolfposition]["l"];
            oWolfs.style.top = arrPos[wolfposition]["t"];

            //随机出现哪种狼 0为灰太狼  1为小灰灰
            var wolfType = ran(0, 1);
            //var wolfType = ran(0, 4) == 3 ? 1 : 0; //增加灰太狼出现的概率
            var count = 0; //定时器走过的次数
            var index = 0; //记录图片的下标
            moveTimer = setInterval(function () {
                if (count < 6) {
                    newWolf.src = wolfArr[wolfType][index];
                    index++;
                } else if (count >= 6 && count <= 11) {
                    index--;
                    newWolf.src = wolfArr[wolfType][index];
                } else {
                    clearInterval(moveTimer);
                    oWolfs.removeChild(newWolf);
                    createWolf();
                }
                count++;

            }, 100);

            //计分时防止重复点击
            //按钮点击  第一次执行函数内的代码  第二次不执行
            //定义变量  第一次点击可以进入判断  改变其值
            var a = 0;
            oWolfs.onclick = function () {
                if (a == 0) {
                    if (wolfType == 0) {
                        score += 10;
                    } else {
                        score -= 10;
                    }
                    a = 1;

                    oScore.innerHTML = score;

                    //不管之前是哪张图片,都变成被打带锅的图片
                    clearInterval(moveTimer);
                    index = 6;
                    moveTimer = setInterval(function () {
                        if (index < 10) {
                            newWolf.src = wolfArr[wolfType][index];
                            index++;
                        } else {
                            clearInterval(moveTimer);
                            oWolfs.removeChild(newWolf);
                            createWolf();
                        }

                    }, 150);
                }

            }
        }
	</script>

</html>